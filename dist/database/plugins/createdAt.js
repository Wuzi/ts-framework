"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
function CreatedAtPlugin(schema, options) {
    schema.add({ created_at: { type: Date, defaults: Date.now } });
    schema.pre('save', function (next) {
        const self = this;
        if (!self.created_at) {
            self.created_at = new Date();
        }
        next();
    });
    if (options && options.index) {
        schema.path('created_at').index(options.index);
    }
}
exports.default = CreatedAtPlugin;
;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY3JlYXRlZEF0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vbGliL2RhdGFiYXNlL3BsdWdpbnMvY3JlYXRlZEF0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEseUJBQXdDLE1BQU0sRUFBRSxPQUFPO0lBQ3JELE1BQU0sQ0FBQyxHQUFHLENBQUMsRUFBRSxVQUFVLEVBQUUsRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLFFBQVEsRUFBRSxJQUFJLENBQUMsR0FBRyxFQUFFLEVBQUUsQ0FBQyxDQUFDO0lBRS9ELE1BQU0sQ0FBQyxHQUFHLENBQUMsTUFBTSxFQUFFLFVBQVUsSUFBSTtRQUMvQixNQUFNLElBQUksR0FBRyxJQUFJLENBQUM7UUFFbEIsRUFBRSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQztZQUNyQixJQUFJLENBQUMsVUFBVSxHQUFHLElBQUksSUFBSSxFQUFFLENBQUM7UUFDL0IsQ0FBQztRQUVELElBQUksRUFBRSxDQUFDO0lBQ1QsQ0FBQyxDQUFDLENBQUM7SUFFSCxFQUFFLENBQUMsQ0FBQyxPQUFPLElBQUksT0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUM7UUFDN0IsTUFBTSxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUMsQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQ2pELENBQUM7QUFDSCxDQUFDO0FBaEJELGtDQWdCQztBQUFBLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBDcmVhdGVkQXRQbHVnaW4oc2NoZW1hLCBvcHRpb25zKSB7XG4gIHNjaGVtYS5hZGQoeyBjcmVhdGVkX2F0OiB7IHR5cGU6IERhdGUsIGRlZmF1bHRzOiBEYXRlLm5vdyB9IH0pO1xuXG4gIHNjaGVtYS5wcmUoJ3NhdmUnLCBmdW5jdGlvbiAobmV4dCkge1xuICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xuXG4gICAgaWYgKCFzZWxmLmNyZWF0ZWRfYXQpIHtcbiAgICAgIHNlbGYuY3JlYXRlZF9hdCA9IG5ldyBEYXRlKCk7XG4gICAgfVxuXG4gICAgbmV4dCgpO1xuICB9KTtcblxuICBpZiAob3B0aW9ucyAmJiBvcHRpb25zLmluZGV4KSB7XG4gICAgc2NoZW1hLnBhdGgoJ2NyZWF0ZWRfYXQnKS5pbmRleChvcHRpb25zLmluZGV4KTtcbiAgfVxufTtcbiJdfQ==